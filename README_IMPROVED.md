# üöÄ –£–ª—É—á—à–µ–Ω–Ω—ã–π –¢–æ—Ä–≥–æ–≤—ã–π –°–∫—Ä–∏–Ω–µ—Ä v2.0

–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–Ω–µ—Ä –¥–ª—è –∫—Ä–∏–ø—Ç–æ-—Ç–æ—Ä–≥–æ–≤–ª–∏ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–æ–º.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–Ω–æ–≤—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- [API Reference](#api-reference)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
- [–ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥](#–±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥)
- [FAQ](#faq)

---

## üéØ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. Performance Tracking
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–∞–∂–¥–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
- Win Rate –ø–æ —Ç–∏–ø–∞–º —Å–∏–≥–Ω–∞–ª–æ–≤ (PUMP/DUMP/REVERSAL)
- –°—Ä–µ–¥–Ω–∏–π PnL –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
- –ê–ª–µ—Ä—Ç—ã –Ω–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é –º–æ–¥–µ–ª–∏

### 2. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π Scoring
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ min_score –Ω–∞ –æ—Å–Ω–æ–≤–µ:
  - BTC —Ä–µ–∂–∏–º–∞ (trending/ranging/high_vol)
  - –ì–ª–æ–±–∞–ª—å–Ω–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞
  - –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏

### 3. Position Sizing & Risk Management
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
- Stop Loss –∏ Take Profit —É—Ä–æ–≤–Ω–∏ (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π + –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π)
- –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏ ATR
- Risk-adjusted –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

### 4. Volume Profile Analysis
- POC (Point of Control) - —É—Ä–æ–≤–µ–Ω—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –æ–±—ä—ë–º–∞
- VPOC (Volume Weighted POC)
- –ó–Ω–∞—á–∏–º—ã–µ —É—Ä–æ–≤–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è

### 5. Whale Activity Detection
- –î–µ—Ç–µ–∫—Ü–∏—è –∫—Ä—É–ø–Ω—ã—Ö —Å—Ç–µ–Ω –≤ —Å—Ç–∞–∫–∞–Ω–µ –∑–∞—è–≤–æ–∫
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∏—Ç–æ–≤–æ–≥–æ bias (bullish/bearish/neutral)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–∏—Ç–æ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### 6. BTC Correlation Filtering
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä—Ç—Ä–µ–Ω–¥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ BTC
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ –æ–±—â–µ–º—É —Ä—ã–Ω–æ—á–Ω–æ–º—É —Ç—Ä–µ–Ω–¥—É

### 7. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- TTL-–∫—ç—à –¥–ª—è klines (—Å–Ω–∏–∂–µ–Ω–∏–µ API –∑–∞–ø—Ä–æ—Å–æ–≤)
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π
- –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### 8. –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (API/DATA/NETWORK/ANALYSIS)
- –û—Ç–¥–µ–ª—å–Ω—ã–π –ª–æ–≥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### 9. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ó–∞–ø—Ä–æ—Å–æ–≤
- –°–µ–º–∞—Ñ–æ—Ä –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ API
- –ó–∞—â–∏—Ç–∞ –æ—Ç rate limiting
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–π –ª–∏–º–∏—Ç (default: 10 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö)

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
```bash
Python 3.8+
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install aiohttp pandas mplfinance aiogram --break-system-packages
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
```bash
pip install pytest pytest-asyncio --break-system-packages
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
import asyncio
from screener_improved import scanner_loop

async def send_text(text):
    """–§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ–∫—Å—Ç–∞ –≤ Telegram/Discord/etc"""
    print(text)

async def send_photo(photo):
    """–§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≥—Ä–∞—Ñ–∏–∫–∞"""
    pass

async def main():
    min_score = 60  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ —Å–∏–≥–Ω–∞–ª–∞
    await scanner_loop(send_text, send_photo, min_score)

if __name__ == "__main__":
    asyncio.run(main())
```

### –° –∫–∞—Å—Ç–æ–º–Ω—ã–º engine

```python
class TradingEngine:
    async def on_signal(self, signal):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–µ–≥–æ —Å–∏–≥–Ω–∞–ª–∞"""
        print(f"–ù–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª: {signal['symbol']} - {signal['type']}")
        
        # –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –≤—Ö–æ–¥–∞ –≤ —Å–¥–µ–ª–∫—É
        if signal['rating'] >= 75:
            await self.enter_trade(signal)

async def main():
    engine = TradingEngine()
    await scanner_loop(send_text, send_photo, min_score=60, engine=engine)
```

---

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. PerformanceTracker

–¢—Ä–µ–∫–µ—Ä –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–æ–≤.

```python
from screener_improved import PerformanceTracker

tracker = PerformanceTracker(db_path="my_performance.json")

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞
signal_id = tracker.add_signal({
    'symbol': 'BTCUSDT',
    'type': 'BIG PUMP',
    'price': 50000.0,
    'rating': 85,
    'confidence': 0.9
})

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç
await tracker.check_signal_outcome(signal_id, session, check_minutes=15)

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
stats = tracker.get_stats_text()
print(stats)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏
if tracker.should_alert_degradation(threshold=0.45):
    print("‚ö†Ô∏è Win rate —É–ø–∞–ª –Ω–∏–∂–µ 45%!")
```

### 2. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π Min Score

```python
from screener_improved import get_adaptive_min_score

# –í –≤—ã—Å–æ–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
score = get_adaptive_min_score(
    btc_regime="high_vol",
    global_vol=1.8,
    base_score=60
)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: ~75 (—Å—Ç—Ä–æ–∂–µ)

# –í —Å–ø–æ–∫–æ–π–Ω–æ–º —Ä—ã–Ω–∫–µ
score = get_adaptive_min_score(
    btc_regime="ranging",
    global_vol=0.7,
    base_score=60
)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: ~52 (–º—è–≥—á–µ)
```

### 3. Position Sizing

```python
from screener_improved import calculate_position_size

position_info = calculate_position_size(
    rating=85,           # –†–µ–π—Ç–∏–Ω–≥ —Å–∏–≥–Ω–∞–ª–∞
    confidence=0.9,      # –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
    atr=100.0,          # ATR
    risk_score=4,        # –û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–∞
    account_size=1000.0, # –†–∞–∑–º–µ—Ä —Å—á—ë—Ç–∞
    risk_per_trade=0.02  # 2% —Ä–∏—Å–∫–∞ –Ω–∞ —Å–¥–µ–ª–∫—É
)

print(f"–†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏: {position_info['position_size_usdt']} USDT")
print(f"Stop Loss: {position_info['sl_distance_percent']}%")
print(f"Take Profit 1: {position_info['tp_conservative_percent']}%")
print(f"Take Profit 2: {position_info['tp_aggressive_percent']}%")
```

### 4. Volume Profile

```python
from screener_improved import compute_volume_profile

klines = await fetch_klines(session, "BTCUSDT", interval="15", limit=100)
vol_profile = compute_volume_profile(klines, num_levels=20)

print(f"POC (Point of Control): {vol_profile['poc']}")
print(f"VPOC (Volume Weighted): {vol_profile['vpoc']}")
print(f"–ó–Ω–∞—á–∏–º—ã–µ —É—Ä–æ–≤–Ω–∏: {vol_profile['high_volume_levels']}")
```

### 5. Whale Detection

```python
from screener_improved import detect_whale_walls

orderbook = await fetch_orderbook(session, "BTCUSDT", limit=20)
whale_info = detect_whale_walls(orderbook, threshold_multiplier=10.0)

print(f"Bias: {whale_info['bias']}")  # bullish/bearish/neutral
print(f"–ö—Ä—É–ø–Ω—ã—Ö bid —Å—Ç–µ–Ω: {whale_info['whale_bid_count']}")
print(f"–ö—Ä—É–ø–Ω—ã—Ö ask —Å—Ç–µ–Ω: {whale_info['whale_ask_count']}")

if whale_info['whale_bid']:
    price, size = whale_info['whale_bid']
    print(f"–ö—Ä—É–ø–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞ {price}: {size}")
```

### 6. BTC Correlation

```python
from screener_improved import check_btc_correlation

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ BTC
is_valid = await check_btc_correlation(
    symbol="ETHUSDT",
    btc_trend=-7,  # BTC –ø–∞–¥–∞–µ—Ç
    signal_type="BIG PUMP"  # –°–∏–≥–Ω–∞–ª –Ω–∞ —Ä–æ—Å—Ç
)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: False (–∫–æ–Ω—Ç—Ä—Ç—Ä–µ–Ω–¥, –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω)
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

–í –Ω–∞—á–∞–ª–µ `screener_improved.py`:

```python
SYMBOL_COOLDOWN = 300  # –ü–∞—É–∑–∞ –º–µ–∂–¥—É —Å–∏–≥–Ω–∞–ª–∞–º–∏ –ø–æ –æ–¥–Ω–æ–º—É —Å–∏–º–≤–æ–ª—É (—Å–µ–∫)
MAX_CONCURRENT_REQUESTS = 10  # –ú–∞–∫—Å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤
_CACHE_TTL = 60  # –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞ klines (—Å–µ–∫)
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ config.py

```python
# config.py
def load_settings():
    return {
        'strictness_level': 'medium',  # low/medium/high
        'reversal_requires_state': False,
        'reversal_min_delay_bars': 3,
        'reversal_min_score_bonus': 0,
        # ... –¥—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    }
```

---

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞ —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

```python
async with aiohttp.ClientSession() as session:
    signal = await analyze_symbol_async(
        session=session,
        symbol="BTCUSDT",
        min_score=60,
        ticker_info=None
    )
    
    if signal:
        print(f"üöÄ {signal['type']} ‚Äî {signal['symbol']}")
        print(f"–¶–µ–Ω–∞: {signal['price']}")
        print(f"–†–µ–π—Ç–∏–Ω–≥: {signal['rating']}/100")
        print(f"–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {signal['confidence']:.2%}")
        
        # Position sizing
        ps = signal['position_sizing']
        print(f"\nüí∞ Position Sizing:")
        print(f"–†–∞–∑–º–µ—Ä: {ps['position_size_usdt']} USDT")
        print(f"SL: {signal['stop_loss']} ({ps['sl_distance_percent']:.2f}%)")
        print(f"TP1: {signal['take_profit_1']} ({ps['tp_conservative_percent']:.2f}%)")
        print(f"TP2: {signal['take_profit_2']} ({ps['tp_aggressive_percent']:.2f}%)")
        
        # Volume profile
        vp = signal['vol_profile']
        print(f"\nüìä Volume Profile:")
        print(f"POC: {vp['poc']}")
        print(f"–ó–Ω–∞—á–∏–º—ã–µ —É—Ä–æ–≤–Ω–∏: {vp['high_volume_levels'][:3]}")
        
        # Whale activity
        wa = signal['whale_activity']
        print(f"\nüêã Whale Activity:")
        print(f"Bias: {wa['bias']}")
        print(f"Bid walls: {wa['whale_bid_count']}, Ask walls: {wa['whale_ask_count']}")
```

### –ü—Ä–∏–º–µ—Ä 2: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```python
from screener_improved import performance_tracker

# –ö–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç –ø—Ä–æ–≤–µ—Ä—è–µ–º outcomes
async def monitor_performance(session):
    while True:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã
        for signal_id in performance_tracker.signals.keys():
            await performance_tracker.check_signal_outcome(
                signal_id, 
                session, 
                check_minutes=15
            )
        
        # –í—ã–≤–æ–¥–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        stats = performance_tracker.get_stats_text()
        print(stats)
        
        # –ê–ª–µ—Ä—Ç –ø—Ä–∏ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏
        if performance_tracker.should_alert_degradation():
            print("‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï! –ú–æ–¥–µ–ª—å –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç!")
            # –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ—Ä–≥–æ–≤–ª—é –∏ —Ç.–¥.
        
        await asyncio.sleep(900)  # 15 –º–∏–Ω—É—Ç
```

### –ü—Ä–∏–º–µ—Ä 3: –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤

```python
async def analyze_with_custom_filters(session, symbol):
    signal = await analyze_symbol_async(session, symbol, min_score=60)
    
    if not signal:
        return None
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
    vol_profile = signal['vol_profile']
    whale_info = signal['whale_activity']
    
    # –§–∏–ª—å—Ç—Ä 1: POC –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–ª–∏–∑–∫–æ –∫ —Ü–µ–Ω–µ
    if vol_profile['poc']:
        poc_distance = abs(signal['price'] - vol_profile['poc']) / signal['price']
        if poc_distance > 0.02:  # –ë–æ–ª–µ–µ 2% –æ—Ç POC
            print(f"–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ: –¥–∞–ª–µ–∫–æ –æ—Ç POC")
            return None
    
    # –§–∏–ª—å—Ç—Ä 2: Whale bias –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Å–∏–≥–Ω–∞–ª–æ–º
    if "PUMP" in signal['type'] and whale_info['bias'] == 'bearish':
        print(f"–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ: whale bias –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç —Å–∏–≥–Ω–∞–ª—É")
        return None
    
    # –§–∏–ª—å—Ç—Ä 3: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
    if signal['confidence'] < 0.7:
        print(f"–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ: –Ω–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å")
        return None
    
    return signal
```

---

## üìà –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥

### –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫—Ç–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã

```python
import pandas as pd
from datetime import datetime, timedelta

class Backtester:
    def __init__(self, start_date, end_date):
        self.start_date = start_date
        self.end_date = end_date
        self.trades = []
        self.equity_curve = []
    
    async def run(self, session):
        """–ó–∞–ø—É—Å–∫ –±—ç–∫—Ç–µ—Å—Ç–∞"""
        current_date = self.start_date
        
        while current_date < self.end_date:
            # –ü–æ–ª—É—á–∞–µ–º –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —ç—Ç—É –¥–∞—Ç—É
            # (—Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ historical data fetching)
            
            # –ó–∞–ø—É—Å–∫–∞–µ–º analyze_symbol_async
            signal = await analyze_symbol_async(session, "BTCUSDT", min_score=60)
            
            if signal:
                # –°–∏–º—É–ª–∏—Ä—É–µ–º —Å–¥–µ–ª–∫—É
                trade_result = self.simulate_trade(signal)
                self.trades.append(trade_result)
            
            # –î–≤–∏–≥–∞–µ–º—Å—è –≤–ø–µ—Ä—ë–¥ –Ω–∞ 1 —á–∞—Å
            current_date += timedelta(hours=1)
        
        # –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        self.analyze_results()
    
    def simulate_trade(self, signal):
        """–°–∏–º—É–ª—è—Ü–∏—è —Å–¥–µ–ª–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏–≥–Ω–∞–ª–∞"""
        entry_price = signal['price']
        sl_price = signal['stop_loss']
        tp_price = signal['take_profit_1']
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –±—É–¥—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ
        # (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞)
        
        return {
            'entry': entry_price,
            'exit': tp_price,  # –∏–ª–∏ sl_price
            'pnl': (tp_price - entry_price) / entry_price,
            'signal_rating': signal['rating']
        }
    
    def analyze_results(self):
        """–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±—ç–∫—Ç–µ—Å—Ç–∞"""
        df = pd.DataFrame(self.trades)
        
        print(f"–í—Å–µ–≥–æ —Å–¥–µ–ª–æ–∫: {len(df)}")
        print(f"Win Rate: {(df['pnl'] > 0).mean():.2%}")
        print(f"–°—Ä–µ–¥–Ω–∏–π PnL: {df['pnl'].mean():.2%}")
        print(f"Sharpe Ratio: {df['pnl'].mean() / df['pnl'].std():.2f}")
        print(f"Max Drawdown: {df['pnl'].cumsum().min():.2%}")

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
backtester = Backtester(
    start_date=datetime(2024, 1, 1),
    end_date=datetime(2024, 12, 31)
)
await backtester.run(session)
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
pytest test_screener.py -v

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–ª–∞—Å—Å —Ç–µ—Å—Ç–æ–≤
pytest test_screener.py::TestAdaptiveMinScore -v

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
pytest test_screener.py --cov=screener_improved --cov-report=html
```

### –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞

```python
def test_position_sizing_with_high_risk():
    """–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –¥–æ–ª–∂–µ–Ω —É–º–µ–Ω—å—à–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é"""
    pos_safe = calculate_position_size(80, 0.8, 10.0, risk_score=2)
    pos_risky = calculate_position_size(80, 0.8, 10.0, risk_score=9)
    
    assert pos_risky['position_size_usdt'] < pos_safe['position_size_usdt']
```

---

## ‚ùì FAQ

### Q: –ö–∞–∫ —á–∞—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è BTC –∫–æ–Ω—Ç–µ–∫—Å—Ç?
A: BTC –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫—ç—à–∏—Ä—É–µ—Ç—Å—è –Ω–∞ 2 –º–∏–Ω—É—Ç—ã –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ API.

### Q: –ú–æ–∂–Ω–æ –ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤?
A: –î–∞, –∏–∑–º–µ–Ω–∏—Ç–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É `MAX_CONCURRENT_REQUESTS` –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞.

### Q: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π min_score?
A: –ü–æ—Ä–æ–≥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—ã—à–∞–µ—Ç—Å—è –≤ –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö –∏ —Å–Ω–∏–∂–∞–µ—Ç—Å—è –≤ —Å–ø–æ–∫–æ–π–Ω—ã—Ö, —á—Ç–æ–±—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–æ–≤.

### Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ Win Rate –ø–∞–¥–∞–µ—Ç?
A: 
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —á–µ—Ä–µ–∑ `performance_tracker.get_stats_text()`
2. –£–≤–µ–ª–∏—á—å—Ç–µ `min_score` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. –î–æ–±–∞–≤—å—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (whale bias, volume profile)
4. –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã position sizing

### Q: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ —Ñ–∏–ª—å—Ç—Ä—ã?
A: –°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é-–æ–±—ë—Ä—Ç–∫—É –Ω–∞–¥ `analyze_symbol_async`, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è (—Å–º. –ü—Ä–∏–º–µ—Ä 3).

### Q: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ª–∏ paper trading?
A: –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏, –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å `TradingEngine` –∫–æ—Ç–æ—Ä—ã–π —Å–∏–º—É–ª–∏—Ä—É–µ—Ç —Å–¥–µ–ª–∫–∏ –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö.

### Q: –ö–∞–∫ –±—ç–∫—Ç–µ—Å—Ç–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é?
A: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª–∞—Å—Å `Backtester` –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥" –∏–ª–∏ —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ —Å–≤–æ—é —Å–∏—Å—Ç–µ–º—É —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤:
–í—Å–µ–≥–æ: 847 | –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ: 623
–£—Å–ø–µ—à–Ω—ã—Ö: 398 | –ù–µ—É–¥–∞—á–Ω—ã—Ö: 225
Win Rate: PUMP=68.2% | DUMP=61.4% | REVERSAL=58.9%
–°—Ä–µ–¥–Ω–∏–π PnL: 1.34%
```

---

## üîÑ Changelog

### v2.0 (–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è)
- ‚úÖ Performance tracking —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π outcomes
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π min_score –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
- ‚úÖ Position sizing –∏ risk management
- ‚úÖ Volume profile analysis (POC/VPOC)
- ‚úÖ Whale activity detection
- ‚úÖ BTC correlation filtering
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å TTL
- ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ Unit —Ç–µ—Å—Ç—ã

### v1.0 (–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)
- –ë–∞–∑–æ–≤—ã–π —Å–∫—Ä–∏–Ω–µ—Ä —Å –¥–µ—Ç–µ–∫—Ü–∏–µ–π pump/dump
- HTF –∞–Ω–∞–ª–∏–∑
- Symbol memory
- Smart filters v3

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω—ã–π –∫–æ–¥. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.

---

## üë®‚Äçüíª –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ `errors.log` –∏ `critical_errors.log`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã: `pytest test_screener.py -v`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ API –¥–æ—Å—Ç—É–ø–µ–Ω

---

## üéØ Roadmap

–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

- [ ] Machine Learning –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è outcomes
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ –±–∏—Ä–∂–∞–º–∏ (Binance, Bybit)
- [ ] Web dashboard –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- [ ] Auto-optimization –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ backtest
- [ ] Multi-timeframe confirmation system
- [ ] Smart Money Concepts (CHoCH, BOS, Order Blocks)
- [ ] Real-time alerts —á–µ—Ä–µ–∑ Telegram/Discord
- [ ] Portfolio management –º–æ–¥—É–ª—å

---

**–£—Å–ø–µ—à–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏! üöÄ**
